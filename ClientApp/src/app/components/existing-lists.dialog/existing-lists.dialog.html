<h2 mat-dialog-title>Existující seznamy</h2>

<mat-dialog-content style="width: 700px;">

    <table mat-table [dataSource]="dataSource" matSort matSortActive="name" matSortDirection="asc"
        matSortDisableClear>

        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Název: </th>
            <td mat-cell *matCellDef="let item" style="text-align: left;">
                <form [formGroup]="form">
                    <div *ngIf="!inEdit[item.id]">
                        {{item.name}}
                        <button matIconButton (click)="edit(item)" title="Přejmenovat" class="compact">
                            <mat-icon>edit</mat-icon>
                        </button>
                    </div>
                    <div *ngIf="inEdit[item.id]">
                        <div style="display: flex; align-items: center;">
                            <input type="text" minlength="1" maxlength="20" formControlName="name" matInput
                                oninput="validity.valid||(value='');" style="flex-grow: 1;">
                            <button matIconButton title="Potvrdit" class="compact" (click)="save(item)"
                                [disabled]="!form.controls.name.valid">
                                <mat-icon>save</mat-icon>
                            </button>
                        </div>
                    </div>
                </form>
            </td>
        </ng-container>

        <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Datum: </th>
            <td mat-cell *matCellDef="let item" style="text-align: center;">
                {{item.createdAt | date:'dd.MM.yyyy HH:mm:ss'}}
            </td>
        </ng-container>

        <ng-container matColumnDef="pricesCount">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Počet cen: </th>
            <td mat-cell *matCellDef="let item" style="text-align: right;">
                {{item.prices.length}}
            </td>
        </ng-container>

        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let item" style="text-align: center;">
                <button matIconButton (click)="delete(item)" title="Smazat">
                    <mat-icon>delete</mat-icon>
                </button>
                <button matIconButton (click)="select(item)" title="Vybrat">
                    <mat-icon>select_all</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[10]" showFirstLastButtons aria-label="Vyber stránku" />

</mat-dialog-content>

<mat-dialog-actions [ngBusy]="busy">
    <button matButton (click)="create()" title="Vytvořit nový">
        <mat-icon>add</mat-icon>
        Vytvořit nový
    </button>
    <button matButton (click)="close()" title="Zrušit">
        <mat-icon>cancel</mat-icon>
        Zrušit
    </button>
    <button matButton (click)="ok()" title="Potvrdit">
        <mat-icon>check</mat-icon>
        Potvrdit
    </button>
</mat-dialog-actions>